---
title: "Script Mattheus 2.0"
author: "Gijs Custers"
date: "7 juli 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

### load relevant packages

library(tidyverse)
library(foreign)

```

Load data and select relevant variables, 2008 (base dataset)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

## load raw data

data2008 <- read.spss("C:/Data Mattheus 2.0/Sociale Index enquete 2008 edit.sav", use.value.labels = FALSE, to.data.frame = TRUE)

View(data2008)

#### select relevant variables, based on "Overzicht variabelen waves Wijkprofiel v2.xlsx"

data2008sel <- data2008 %>% select(v1, v2, v3a, etni, v9, v12d, v13, v14a_1, v14a_2, v14a_3, v18a, v18b, v18c, v18d, v18e, v18f, v18g, v18h, v18i, v18j, v18k, v18l, v23b, v24a, v27, v28, v29a, v33, v48a, v48b, v48c, v49, v55a, buurt, ijssel, GEWICHT_STAD, WAVEID)

```

Data transformations 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

## recode and rename variables

#Gender
data2008sel$v2[data2008sel$v2==2] <- 0
v2_labels <- c("Female", "Male")
data2008sel$v2 <- factor(data2008sel$v2, labels = v2_labels, ordered = FALSE)

#Household
data2008sel$v3a <- recode(data2008sel$v3a, "5:12 = 5; 97:98=NA")
v3a_labels <- c("SingleHH","Couplechild","Couplenochild","SingleparentHH","Other")
data2008sel$v3a <- factor(data2008sel$v3a, labels = v3a_labels, ordered = FALSE)

#Ethnicity
etni_labels <- c("Dutch", "Turkish", "Moroccan","Antillean", "Surinamese", "Cape-Verdean","Other")
data2008sel$etni <- factor(data2008sel$etni, labels = etni_labels, ordered = FALSE)

#Tenure
data2008sel$v9 <-recode(data2008sel$v9, "3=NA;2=1;1=0")
v9_labels <- c("Rent", "Owner")
data2008sel$v9 <- factor(data2008sel$v9, labels = v9_labels, ordered = FALSE)

#Neigh_responsibility
#response coding: 1=helemaal niet ... 5 = ja heel erg
data2008sel$v13 <- 6 - data2008sel$v13
data2008sel$v13[data2008sel$v13==0]<- NA

#Neighb_involve
data2008sel$v14a_1 <- recode(data2008sel$v14a_1, "5=0; 1:3=1")
v14a_1_labels <- c("No", "Yes")
data2008sel$v14a_1 <- factor(data2008sel$v14a_1, labels = v14a_1_labels, ordered = FALSE)



#countvariable involvement (nog uit te vogelen hoe makkelijk te counten)
data2008sel$v14a_2 <- recode(data2008sel$v14a_2, "1:3=1; NA=0")
data2008sel$v14a_3 <- recode(data2008sel$v14a_3, "1:3=1; NA=0")

data2008sel$Count_involve <- data2008sel$v14a_1 + data2008sel$v14a_2 + data2008sel$v14a_3 

table(data2008sel$v14a_3, exclude = NULL)


table(data2008sel$Count_involve, exclude = NULL)




#variable names recoding
data2008sel <- data2008sel %>% rename(Age = v1, Male = v2, Household = v3a, Ethnicity = etni, Tenure = v9,
                                      Adress_years = v12d, Neigh_responsibility = v13, Neigh_involve = v14a_1)

```





